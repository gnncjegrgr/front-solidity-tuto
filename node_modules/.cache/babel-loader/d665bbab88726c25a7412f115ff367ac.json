{"ast":null,"code":"'use strict';\n\nvar BN = require('./bn');\n\nfunction ECJPoint(x, y, z) {\n  if (x === null && y === null && z === null) {\n    this.x = ECJPoint.one;\n    this.y = ECJPoint.one;\n    this.z = ECJPoint.zero;\n  } else {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n  }\n\n  this.zOne = this.z === ECJPoint.one;\n}\n\nECJPoint.zero = BN.fromNumber(0);\nECJPoint.one = BN.fromNumber(1);\n\nECJPoint.prototype.neg = function () {\n  if (this.inf) return this;\n  return new ECJPoint(this.x, this.y.redNeg(), this.z);\n};\n\nECJPoint.prototype.add = function (p) {\n  // O + P = P\n  if (this.inf) return p; // P + O = P\n\n  if (p.inf) return this; // http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-0.html#addition-add-1998-cmo-2\n  // 12M + 4S + 7A\n\n  var pz2 = p.z.redSqr();\n  var z2 = this.z.redSqr();\n  var u1 = this.x.redMul(pz2);\n  var u2 = p.x.redMul(z2);\n  var s1 = this.y.redMul(pz2).redMul(p.z);\n  var s2 = p.y.redMul(z2).redMul(this.z);\n  var h = u1.redSub(u2);\n  var r = s1.redSub(s2);\n\n  if (h.isZero()) {\n    if (r.isZero()) return this.dbl();\n    return new ECJPoint(null, null, null);\n  }\n\n  var h2 = h.redSqr();\n  var v = u1.redMul(h2);\n  var h3 = h2.redMul(h);\n  var nx = r.redSqr().redIAdd(h3).redISub(v).redISub(v);\n  var ny = r.redMul(v.redISub(nx)).redISub(s1.redMul(h3));\n  var nz = this.z.redMul(p.z).redMul(h);\n  return new ECJPoint(nx, ny, nz);\n};\n\nECJPoint.prototype.mixedAdd = function (p) {\n  // O + P = P\n  if (this.inf) return p.toECJPoint(); // P + O = P\n\n  if (p.inf) return this; // http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-0.html#addition-add-1998-cmo-2\n  //   with p.z = 1\n  // 8M + 3S + 7A\n\n  var z2 = this.z.redSqr();\n  var u1 = this.x;\n  var u2 = p.x.redMul(z2);\n  var s1 = this.y;\n  var s2 = p.y.redMul(z2).redMul(this.z);\n  var h = u1.redSub(u2);\n  var r = s1.redSub(s2);\n\n  if (h.isZero()) {\n    if (r.isZero()) return this.dbl();\n    return new ECJPoint(null, null, null);\n  }\n\n  var h2 = h.redSqr();\n  var v = u1.redMul(h2);\n  var h3 = h2.redMul(h);\n  var nx = r.redSqr().redIAdd(h3).redISub(v).redISub(v);\n  var ny = r.redMul(v.redISub(nx)).redISub(s1.redMul(h3));\n  var nz = this.z.redMul(h);\n  return new ECJPoint(nx, ny, nz);\n};\n\nECJPoint.prototype.dbl = function () {\n  if (this.inf) return this;\n  var nx;\n  var ny;\n  var nz; // Z = 1\n\n  if (this.zOne) {\n    // http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-0.html#doubling-mdbl-2007-bl\n    // 1M + 5S + 6A + 3*2 + 1*3 + 1*8\n    // XX = X1^2\n    var xx = this.x.redSqr(); // YY = Y1^2\n\n    var yy = this.y.redSqr(); // YYYY = YY^2\n\n    var yyyy = yy.redSqr(); // S = 2 * ((X1 + YY)^2 - XX - YYYY)\n\n    var s = this.x.redAdd(yy).redSqr().redISub(xx).redISub(yyyy);\n    s = s.redIAdd(s); // M = 3 * XX\n\n    var m = xx.redAdd(xx).redIAdd(xx); // T = M ^ 2 - 2*S\n\n    var t = m.redSqr().redISub(s).redISub(s); // 8 * YYYY\n\n    var yyyy8 = yyyy.redIAdd(yyyy).redIAdd(yyyy).redIAdd(yyyy); // X3 = T\n\n    nx = t; // Y3 = M * (S - T) - 8 * YYYY\n\n    ny = m.redMul(s.redISub(t)).redISub(yyyy8); // Z3 = 2*Y1\n\n    nz = this.y.redAdd(this.y);\n  } else {\n    // http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-0.html#doubling-dbl-2009-l\n    // 2M + 5S + 6A + 3*2 + 1*3 + 1*8\n    // A = X1^2\n    var a = this.x.redSqr(); // B = Y1^2\n\n    var b = this.y.redSqr(); // C = B^2\n\n    var c = b.redSqr(); // D = 2 * ((X1 + B)^2 - A - C)\n\n    var d = this.x.redAdd(b).redSqr().redISub(a).redISub(c);\n    d = d.redIAdd(d); // E = 3 * A\n\n    var e = a.redAdd(a).redIAdd(a); // F = E^2\n\n    var f = e.redSqr(); // 8 * C\n\n    var c8 = c.redIAdd(c).redIAdd(c).redIAdd(c); // X3 = F - 2 * D\n\n    nx = f.redISub(d).redISub(d); // Y3 = E * (D - X3) - 8 * C\n\n    ny = e.redMul(d.redISub(nx)).redISub(c8); // Z3 = 2 * Y1 * Z1\n\n    nz = this.y.redMul(this.z);\n    nz = nz.redIAdd(nz);\n  }\n\n  return new ECJPoint(nx, ny, nz);\n};\n\nECJPoint.prototype.dblp = function (pow) {\n  if (pow === 0 || this.inf) return this;\n  var point = this;\n\n  for (var i = 0; i < pow; i++) point = point.dbl();\n\n  return point;\n};\n\nObject.defineProperty(ECJPoint.prototype, 'inf', {\n  enumerable: true,\n  get: function () {\n    return this.z.isZero();\n  }\n});\nmodule.exports = ECJPoint;","map":{"version":3,"sources":["C:/Users/kimyo/skkrypto project/skkrypto-front-solidity/node_modules/secp256k1/lib/js/ecjpoint.js"],"names":["BN","require","ECJPoint","x","y","z","one","zero","zOne","fromNumber","prototype","neg","inf","redNeg","add","p","pz2","redSqr","z2","u1","redMul","u2","s1","s2","h","redSub","r","isZero","dbl","h2","v","h3","nx","redIAdd","redISub","ny","nz","mixedAdd","toECJPoint","xx","yy","yyyy","s","redAdd","m","t","yyyy8","a","b","c","d","e","f","c8","dblp","pow","point","i","Object","defineProperty","enumerable","get","module","exports"],"mappings":"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","sourcesContent":["'use strict'\r\nvar BN = require('./bn')\r\n\r\nfunction ECJPoint (x, y, z) {\r\n  if (x === null && y === null && z === null) {\r\n    this.x = ECJPoint.one\r\n    this.y = ECJPoint.one\r\n    this.z = ECJPoint.zero\r\n  } else {\r\n    this.x = x\r\n    this.y = y\r\n    this.z = z\r\n  }\r\n\r\n  this.zOne = this.z === ECJPoint.one\r\n}\r\n\r\nECJPoint.zero = BN.fromNumber(0)\r\nECJPoint.one = BN.fromNumber(1)\r\n\r\nECJPoint.prototype.neg = function () {\r\n  if (this.inf) return this\r\n\r\n  return new ECJPoint(this.x, this.y.redNeg(), this.z)\r\n}\r\n\r\nECJPoint.prototype.add = function (p) {\r\n  // O + P = P\r\n  if (this.inf) return p\r\n\r\n  // P + O = P\r\n  if (p.inf) return this\r\n\r\n  // http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-0.html#addition-add-1998-cmo-2\r\n  // 12M + 4S + 7A\r\n  var pz2 = p.z.redSqr()\r\n  var z2 = this.z.redSqr()\r\n  var u1 = this.x.redMul(pz2)\r\n  var u2 = p.x.redMul(z2)\r\n  var s1 = this.y.redMul(pz2).redMul(p.z)\r\n  var s2 = p.y.redMul(z2).redMul(this.z)\r\n\r\n  var h = u1.redSub(u2)\r\n  var r = s1.redSub(s2)\r\n  if (h.isZero()) {\r\n    if (r.isZero()) return this.dbl()\r\n    return new ECJPoint(null, null, null)\r\n  }\r\n\r\n  var h2 = h.redSqr()\r\n  var v = u1.redMul(h2)\r\n  var h3 = h2.redMul(h)\r\n\r\n  var nx = r.redSqr().redIAdd(h3).redISub(v).redISub(v)\r\n  var ny = r.redMul(v.redISub(nx)).redISub(s1.redMul(h3))\r\n  var nz = this.z.redMul(p.z).redMul(h)\r\n\r\n  return new ECJPoint(nx, ny, nz)\r\n}\r\n\r\nECJPoint.prototype.mixedAdd = function (p) {\r\n  // O + P = P\r\n  if (this.inf) return p.toECJPoint()\r\n\r\n  // P + O = P\r\n  if (p.inf) return this\r\n\r\n  // http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-0.html#addition-add-1998-cmo-2\r\n  //   with p.z = 1\r\n  // 8M + 3S + 7A\r\n  var z2 = this.z.redSqr()\r\n  var u1 = this.x\r\n  var u2 = p.x.redMul(z2)\r\n  var s1 = this.y\r\n  var s2 = p.y.redMul(z2).redMul(this.z)\r\n\r\n  var h = u1.redSub(u2)\r\n  var r = s1.redSub(s2)\r\n  if (h.isZero()) {\r\n    if (r.isZero()) return this.dbl()\r\n    return new ECJPoint(null, null, null)\r\n  }\r\n\r\n  var h2 = h.redSqr()\r\n  var v = u1.redMul(h2)\r\n  var h3 = h2.redMul(h)\r\n\r\n  var nx = r.redSqr().redIAdd(h3).redISub(v).redISub(v)\r\n  var ny = r.redMul(v.redISub(nx)).redISub(s1.redMul(h3))\r\n  var nz = this.z.redMul(h)\r\n\r\n  return new ECJPoint(nx, ny, nz)\r\n}\r\n\r\nECJPoint.prototype.dbl = function () {\r\n  if (this.inf) return this\r\n\r\n  var nx\r\n  var ny\r\n  var nz\r\n\r\n  // Z = 1\r\n  if (this.zOne) {\r\n    // http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-0.html#doubling-mdbl-2007-bl\r\n    // 1M + 5S + 6A + 3*2 + 1*3 + 1*8\r\n\r\n    // XX = X1^2\r\n    var xx = this.x.redSqr()\r\n    // YY = Y1^2\r\n    var yy = this.y.redSqr()\r\n    // YYYY = YY^2\r\n    var yyyy = yy.redSqr()\r\n    // S = 2 * ((X1 + YY)^2 - XX - YYYY)\r\n    var s = this.x.redAdd(yy).redSqr().redISub(xx).redISub(yyyy)\r\n    s = s.redIAdd(s)\r\n    // M = 3 * XX\r\n    var m = xx.redAdd(xx).redIAdd(xx)\r\n    // T = M ^ 2 - 2*S\r\n    var t = m.redSqr().redISub(s).redISub(s)\r\n\r\n    // 8 * YYYY\r\n    var yyyy8 = yyyy.redIAdd(yyyy).redIAdd(yyyy).redIAdd(yyyy)\r\n\r\n    // X3 = T\r\n    nx = t\r\n    // Y3 = M * (S - T) - 8 * YYYY\r\n    ny = m.redMul(s.redISub(t)).redISub(yyyy8)\r\n    // Z3 = 2*Y1\r\n    nz = this.y.redAdd(this.y)\r\n  } else {\r\n    // http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-0.html#doubling-dbl-2009-l\r\n    // 2M + 5S + 6A + 3*2 + 1*3 + 1*8\r\n\r\n    // A = X1^2\r\n    var a = this.x.redSqr()\r\n    // B = Y1^2\r\n    var b = this.y.redSqr()\r\n    // C = B^2\r\n    var c = b.redSqr()\r\n    // D = 2 * ((X1 + B)^2 - A - C)\r\n    var d = this.x.redAdd(b).redSqr().redISub(a).redISub(c)\r\n    d = d.redIAdd(d)\r\n    // E = 3 * A\r\n    var e = a.redAdd(a).redIAdd(a)\r\n    // F = E^2\r\n    var f = e.redSqr()\r\n\r\n    // 8 * C\r\n    var c8 = c.redIAdd(c).redIAdd(c).redIAdd(c)\r\n\r\n    // X3 = F - 2 * D\r\n    nx = f.redISub(d).redISub(d)\r\n    // Y3 = E * (D - X3) - 8 * C\r\n    ny = e.redMul(d.redISub(nx)).redISub(c8)\r\n    // Z3 = 2 * Y1 * Z1\r\n    nz = this.y.redMul(this.z)\r\n    nz = nz.redIAdd(nz)\r\n  }\r\n\r\n  return new ECJPoint(nx, ny, nz)\r\n}\r\n\r\nECJPoint.prototype.dblp = function (pow) {\r\n  if (pow === 0 || this.inf) return this\r\n\r\n  var point = this\r\n  for (var i = 0; i < pow; i++) point = point.dbl()\r\n\r\n  return point\r\n}\r\n\r\nObject.defineProperty(ECJPoint.prototype, 'inf', {\r\n  enumerable: true,\r\n  get: function () {\r\n    return this.z.isZero()\r\n  }\r\n})\r\n\r\nmodule.exports = ECJPoint\r\n"]},"metadata":{},"sourceType":"script"}