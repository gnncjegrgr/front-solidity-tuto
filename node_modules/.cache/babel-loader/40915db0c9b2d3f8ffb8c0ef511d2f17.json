{"ast":null,"code":"'use strict';\n\nconst promisify = require('promisify-es6');\n\nconst Block = require('ipfs-block');\n\nconst CID = require('cids');\n\nconst multihash = require('multihashes');\n\nconst SendOneFile = require('../utils/send-one-file');\n\nmodule.exports = send => {\n  const sendOneFile = SendOneFile(send, 'block/put');\n  return promisify((block, options, callback) => {\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    options = options || {};\n\n    if (Array.isArray(block)) {\n      return callback(new Error('block.put accepts only one block'));\n    }\n\n    if (Buffer.isBuffer(block)) {\n      block = {\n        data: block\n      };\n    }\n\n    if (!block || !block.data) {\n      return callback(new Error('invalid block arg'));\n    }\n\n    const qs = {};\n\n    if (block.cid || options.cid) {\n      let cid;\n\n      try {\n        cid = new CID(block.cid || options.cid);\n      } catch (err) {\n        return callback(err);\n      }\n\n      const {\n        name,\n        length\n      } = multihash.decode(cid.multihash);\n      qs.format = cid.codec;\n      qs.mhtype = name;\n      qs.mhlen = length;\n      qs.version = cid.version;\n    } else {\n      if (options.format) qs.format = options.format;\n      if (options.mhtype) qs.mhtype = options.mhtype;\n      if (options.mhlen) qs.mhlen = options.mhlen;\n      if (options.version != null) qs.version = options.version;\n    }\n\n    sendOneFile(block.data, {\n      qs\n    }, (err, result) => {\n      if (err) {\n        // Retry with \"protobuf\"/\"cbor\" format for go-ipfs\n        // TODO: remove when https://github.com/ipfs/go-cid/issues/75 resolved\n        if (qs.format === 'dag-pb' || qs.format === 'dag-cbor') {\n          qs.format = qs.format === 'dag-pb' ? 'protobuf' : 'cbor';\n          return sendOneFile(block.data, {\n            qs\n          }, (err, result) => {\n            if (err) return callback(err);\n            callback(null, new Block(block.data, new CID(result.Key)));\n          });\n        }\n\n        return callback(err);\n      }\n\n      callback(null, new Block(block.data, new CID(result.Key)));\n    });\n  });\n};","map":{"version":3,"sources":["C:/Users/kimyo/skkrypto project/skkrypto-front-solidity/node_modules/ipfs-http-client/src/block/put.js"],"names":["promisify","require","Block","CID","multihash","SendOneFile","module","exports","send","sendOneFile","block","options","callback","Array","isArray","Error","Buffer","isBuffer","data","qs","cid","err","name","length","decode","format","codec","mhtype","mhlen","version","result","Key"],"mappings":"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","sourcesContent":["'use strict'\r\n\r\nconst promisify = require('promisify-es6')\r\nconst Block = require('ipfs-block')\r\nconst CID = require('cids')\r\nconst multihash = require('multihashes')\r\nconst SendOneFile = require('../utils/send-one-file')\r\n\r\nmodule.exports = (send) => {\r\n  const sendOneFile = SendOneFile(send, 'block/put')\r\n\r\n  return promisify((block, options, callback) => {\r\n    if (typeof options === 'function') {\r\n      callback = options\r\n      options = {}\r\n    }\r\n\r\n    options = options || {}\r\n\r\n    if (Array.isArray(block)) {\r\n      return callback(new Error('block.put accepts only one block'))\r\n    }\r\n\r\n    if (Buffer.isBuffer(block)) {\r\n      block = { data: block }\r\n    }\r\n\r\n    if (!block || !block.data) {\r\n      return callback(new Error('invalid block arg'))\r\n    }\r\n\r\n    const qs = {}\r\n\r\n    if (block.cid || options.cid) {\r\n      let cid\r\n\r\n      try {\r\n        cid = new CID(block.cid || options.cid)\r\n      } catch (err) {\r\n        return callback(err)\r\n      }\r\n\r\n      const { name, length } = multihash.decode(cid.multihash)\r\n\r\n      qs.format = cid.codec\r\n      qs.mhtype = name\r\n      qs.mhlen = length\r\n      qs.version = cid.version\r\n    } else {\r\n      if (options.format) qs.format = options.format\r\n      if (options.mhtype) qs.mhtype = options.mhtype\r\n      if (options.mhlen) qs.mhlen = options.mhlen\r\n      if (options.version != null) qs.version = options.version\r\n    }\r\n\r\n    sendOneFile(block.data, { qs }, (err, result) => {\r\n      if (err) {\r\n        // Retry with \"protobuf\"/\"cbor\" format for go-ipfs\r\n        // TODO: remove when https://github.com/ipfs/go-cid/issues/75 resolved\r\n        if (qs.format === 'dag-pb' || qs.format === 'dag-cbor') {\r\n          qs.format = qs.format === 'dag-pb' ? 'protobuf' : 'cbor'\r\n          return sendOneFile(block.data, { qs }, (err, result) => {\r\n            if (err) return callback(err)\r\n            callback(null, new Block(block.data, new CID(result.Key)))\r\n          })\r\n        }\r\n\r\n        return callback(err)\r\n      }\r\n\r\n      callback(null, new Block(block.data, new CID(result.Key)))\r\n    })\r\n  })\r\n}\r\n"]},"metadata":{},"sourceType":"script"}