{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\kimyo\\\\skkrypto project\\\\frontend\\\\src\\\\pages\\\\Sell.js\";\nimport Caver from \"caver-js\";\nimport { Button } from \"@mui/material\";\nimport { useEffect } from \"react\";\nimport { STCONTRACT, TSCONTRACT } from \"../variables\";\nimport ST_ADDRESS from \"../contractInfo/SKKRYPTOCONTRACT/STCONTRACT_ADDRESS.json\";\nimport TS_ADDRESS from \"../contractInfo/SKKRYPTOCONTRACT/TOKENSALES_ADDRESS.json\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Sell = () => {\n  const caver = new Caver(window.klaytn);\n  const feePayer = caver.klay.accounts.wallet.add( //클레이튼 개인키로 추가해줍니다.\n  \"0x8cafa33df8c1740720bc4815ce7c7cd61d18aaf396bb2a3da5e197f0c7b85aff\");\n\n  const approve = async () => {\n    STCONTRACT.methods.setApprovalForAll(TS_ADDRESS, true).send({\n      from: window.klaytn.selectedAddress,\n      gas: \"250000\"\n    }).then(receipt => {\n      console.log(receipt);\n    });\n  };\n\n  const cancelApprove = async () => {\n    STCONTRACT.methods.setApprovalForAll(TS_ADDRESS, false).send({\n      from: window.klaytn.selectedAddress,\n      gas: \"250000\"\n    }).then(receipt => {\n      console.log(receipt);\n    });\n  };\n\n  const sellToken = async () => {\n    const {\n      rawTransaction: senderRawTransaction\n    } = await cav.klay.accounts.signTransaction({\n      type: \"FEE_DELEGATED_SMART_CONTRACT_EXECUTION\",\n      from: window.klaytn.selectedAddress,\n      to: TS_ADDRESS,\n      data: TSCONTRACT.methods.setForSale(2020312708, cav.utils.toPeb(\"1\", \"peb\")).encodeABI(),\n      gas: \"500000\",\n      value: cav.utils.toPeb(\"0\", \"KLAY\") // payable 타입일때는 1\n\n    }, sender.privateKey);\n    cav.klay.sendTransaction({\n      senderRawTransaction: senderRawTransaction,\n      feePayer: feePayer.address\n    }).then(function (receipt) {\n      if (receipt.transactionHash) {\n        alert(receipt.transactionHash);\n        location.reload();\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      onClick: approve,\n      children: \"\\uCEE8\\uD2B8\\uB799\\uD2B8\\uC5D0 \\uD310\\uB9E4\\uAD8C\\uD55C \\uC8FC\\uAE30\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      onClick: cancelApprove,\n      children: \"\\uCEE8\\uD2B8\\uB799\\uD2B8\\uC5D0 \\uD310\\uB9E4 \\uAD8C\\uD55C \\uCDE8\\uC18C\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_c = Sell;\nexport default Sell;\n\nvar _c;\n\n$RefreshReg$(_c, \"Sell\");","map":{"version":3,"sources":["C:/Users/kimyo/skkrypto project/frontend/src/pages/Sell.js"],"names":["Caver","Button","useEffect","STCONTRACT","TSCONTRACT","ST_ADDRESS","TS_ADDRESS","Sell","caver","window","klaytn","feePayer","klay","accounts","wallet","add","approve","methods","setApprovalForAll","send","from","selectedAddress","gas","then","receipt","console","log","cancelApprove","sellToken","rawTransaction","senderRawTransaction","cav","signTransaction","type","to","data","setForSale","utils","toPeb","encodeABI","value","sender","privateKey","sendTransaction","address","transactionHash","alert","location","reload"],"mappings":"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","sourcesContent":["import Caver from \"caver-js\";\r\nimport { Button } from \"@mui/material\";\r\nimport { useEffect } from \"react\";\r\nimport { STCONTRACT, TSCONTRACT } from \"../variables\";\r\nimport ST_ADDRESS from \"../contractInfo/SKKRYPTOCONTRACT/STCONTRACT_ADDRESS.json\";\r\nimport TS_ADDRESS from \"../contractInfo/SKKRYPTOCONTRACT/TOKENSALES_ADDRESS.json\";\r\n\r\nconst Sell = () => {\r\n  const caver = new Caver(window.klaytn);\r\n\r\n  const feePayer = caver.klay.accounts.wallet.add(\r\n    //클레이튼 개인키로 추가해줍니다.\r\n    \"0x8cafa33df8c1740720bc4815ce7c7cd61d18aaf396bb2a3da5e197f0c7b85aff\"\r\n  );\r\n\r\n  const approve = async () => {\r\n    STCONTRACT.methods\r\n      .setApprovalForAll(TS_ADDRESS, true)\r\n      .send({\r\n        from: window.klaytn.selectedAddress,\r\n        gas: \"250000\",\r\n      })\r\n      .then((receipt) => {\r\n        console.log(receipt);\r\n      });\r\n  };\r\n\r\n  const cancelApprove = async () => {\r\n    STCONTRACT.methods\r\n      .setApprovalForAll(TS_ADDRESS, false)\r\n      .send({\r\n        from: window.klaytn.selectedAddress,\r\n        gas: \"250000\",\r\n      })\r\n      .then((receipt) => {\r\n        console.log(receipt);\r\n      });\r\n  };\r\n\r\n  const sellToken = async () => {\r\n    const { rawTransaction: senderRawTransaction } =\r\n      await cav.klay.accounts.signTransaction(\r\n        {\r\n          type: \"FEE_DELEGATED_SMART_CONTRACT_EXECUTION\",\r\n          from: window.klaytn.selectedAddress,\r\n          to: TS_ADDRESS,\r\n          data: TSCONTRACT.methods\r\n            .setForSale(2020312708, cav.utils.toPeb(\"1\", \"peb\"))\r\n            .encodeABI(),\r\n          gas: \"500000\",\r\n          value: cav.utils.toPeb(\"0\", \"KLAY\"), // payable 타입일때는 1\r\n        },\r\n        sender.privateKey\r\n      );\r\n\r\n    cav.klay\r\n      .sendTransaction({\r\n        senderRawTransaction: senderRawTransaction,\r\n        feePayer: feePayer.address,\r\n      })\r\n      .then(function (receipt) {\r\n        if (receipt.transactionHash) {\r\n          alert(receipt.transactionHash);\r\n          location.reload();\r\n        }\r\n      });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Button onClick={approve}>컨트랙트에 판매권한 주기</Button>\r\n      <br />\r\n      <Button onClick={cancelApprove}>컨트랙트에 판매 권한 취소</Button>\r\n      <br />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Sell;\r\n"]},"metadata":{},"sourceType":"module"}